rule wscript_shell_executions_for_textfile_js {
    meta: 
        Description = "Rule to find WScript Shell executions in excel files involving textfile.JS"
        Author = "Twitch/notdankenoughq / Github/M-Faheem-Khan"
        Date = "August 13, 2022"

    strings:
        // file header / signature
        $xlsm_file_header = { 50 4b }
        $content_type_xml = { 5b 43 6f 6e 74 65 6e 74 5f 54  79 70 65 73 5d 2e 78 6d 6c }
        // Content to search for
        $file_name = "textfile.JS"
        $textfile_js_path = "C:\\Users\\Public\\textfile.JS"
        $object_shell_initialization = "new ActiveXObject('Wscript.Shell')"
        $mshta_execution_http = "mshta http://"
        $mshta_execution_https = "mshta https://"
    
    condition:
        any of them
}